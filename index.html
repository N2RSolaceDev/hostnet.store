<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HostNet.Wiki - Secure & Innovative Web Hosting</title>
  <meta name="description" content="HostNet.Wiki: Secure and innovative hosting solutions for your website and domain needs."/>
  <meta property="og:title" content="HostNet.Wiki - Secure & Innovative Web Hosting" />
  <meta property="og:description" content="HostNet.Wiki: Secure and innovative hosting solutions for your website and domain needs." />
  <meta property="og:image" content="https://example.com/logo.png" />
  <meta name="theme-color" content="#1E90FF" />
  <link rel="icon" href="https://example.com/favicon.ico" type="image/x-icon" />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #1e1e2f, #2a2a40);
      color: #fff;
      margin: 0;
      padding: 0;
      line-height: 1.6;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      text-align: center;
    }
    h1 {
      font-size: 2.5rem;
      font-weight: bold;
      color: #1E90FF;
      margin-bottom: 10px;
    }
    p {
      font-size: 1rem;
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 20px;
    }
    header {
      background: #111;
      padding: 1rem;
      display: flex;
      justify-content: center;
      align-items: center;
      border-bottom: 2px solid #ff4d4d;
    }
    header .logo {
      font-size: 1.8rem;
      font-weight: bold;
      letter-spacing: 3px;
      color: #ff4d4d;
      text-transform: uppercase;
    }
    .backend-status {
      margin-top: 2rem;
      font-size: 1.2rem;
      color: #6bff6b;
    }
    .backend-status.offline {
      color: #ff1a1a;
    }
    .free-hosting, .instructions, .transfer-form {
      margin-top: 2rem;
      padding: 1.5rem;
      background-color: #1a1a1a;
      border: 1px solid #ff4d4d;
      border-radius: 5px;
      text-align: left;
      color: #ccc;
    }
    .transfer-form input,
    .transfer-form select,
    .transfer-form button {
      width: 100%;
      padding: 10px;
      margin-bottom: 1rem;
      border: none;
      border-radius: 5px;
      background-color: #111;
      color: #ccc;
    }
    .transfer-form button {
      background-color: #ff1a1a;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .transfer-form button:hover {
      background-color: #ff4d4d;
    }
    footer {
      margin-top: 30px;
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.6);
    }
    footer a {
      color: #1E90FF;
      text-decoration: none;
    }
    .g-recaptcha {
      transform: scale(0.88);
      transform-origin: 0 0;
      margin-bottom: 20px;
    }
  </style>

  <!-- Load reCAPTCHA Script -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>

  <!-- Header -->
  <header>
    <div class="logo">HOSTNET.WIKI</div>
  </header>

  <div class="container">
    <h1>Welcome to HostNet.Wiki</h1>
    <p>Secure and innovative web hosting with support for custom domains, HTML uploads, and social embeds.</p>

    <!-- Backend Status -->
    <div class="backend-status" id="backendStatus">Checking backend status...</div>

    <!-- Free Hosting Section -->
    <div class="free-hosting">
      <h3>Free Hosting</h3>
      <p>We offer free hosting with support for custom domains or subdomains like <code>hostnet.wiki/@yourname</code>.</p>
    </div>

    <!-- Transfer Form -->
    <div class="transfer-form">
      <h2>Transfer a Domain to Us</h2>
      <p>Please provide the required information below. All fields are mandatory.</p>
      <form id="transferForm">
        <label for="domainName">Domain Name</label>
        <input type="text" id="domainName" name="domainName" placeholder="example.com" required />

        <label for="authCode">Authorization Code (EPP Code)</label>
        <input type="text" id="authCode" name="authCode" placeholder="Your EPP/Auth Code" required pattern="[A-Za-z0-9\-]+" title="Authorization code must be alphanumeric with optional dashes." />

        <label for="reasonSelect">Reason for Transfer</label>
        <select id="reasonSelect" name="reasonSelect" required>
          <option value="">-- Select a Reason --</option>
          <option value="Image Hosting">Image Hosting</option>
          <option value="Redirect">Redirect to Another Site</option>
          <option value="Other">Other (Please Specify Below)</option>
        </select>

        <div id="imageUploadField" style="display: none;">
          <label for="images">Upload Images (Up to 5 files, 10MB each)</label>
          <input type="file" id="images" name="images" multiple accept="image/*" required>
        </div>

        <div id="redirectField" style="display: none;">
          <label for="redirectDomain">Redirect Domain (e.g., hostnet.wiki or other domain)</label>
          <input type="text" id="redirectDomain" name="redirectDomain" placeholder="hostnet.wiki or other domain">
        </div>

        <label for="customReason">Custom Reason (Required if "Other" is selected)</label>
        <input type="text" id="customReason" name="customReason" placeholder="Type your reason here">

        <!-- reCAPTCHA -->
        <div class="form-group">
          <div class="g-recaptcha" data-sitekey="6LeLxzErAAAAAOfIwlGu34wx1BaKQIoD6I6ZH6aV"></div>
        </div>

        <button type="submit">Submit Request</button>
        <p id="formMessage"></p>
      </form>
    </div>
  </div>

  <footer>
    &copy; 2025 HostNet.Wiki. All rights reserved. |
    <a href="#">Privacy Policy</a> |
    <a href="#">Terms of Service</a>
  </footer>

  <script>
    // Replace with your actual Discord webhook
    const DISCORD_WEBHOOK_URL = 'https://discord.com/api/webhooks/1369719012371726437/6aJepWKi1QDCRySfi4RJsKAFv6xLmyoVmIXYIMe7TjVMYQhDlIMqxsWw6Il8U9kYteHI';

    // Check backend status
    async function checkBackendStatus() {
      const backendStatusElement = document.getElementById("backendStatus");
      try {
        const response = await fetch("https://hostnet-backend.onrender.com/status");
        if (response.ok) {
          backendStatusElement.textContent = "Backend is online";
          backendStatusElement.classList.remove("offline");
        } else {
          throw new Error();
        }
      } catch {
        backendStatusElement.textContent = "Backend is offline";
        backendStatusElement.classList.add("offline");
      }
    }

    // Show/hide conditional fields
    document.getElementById('reasonSelect').addEventListener('change', function () {
      const val = this.value;
      document.getElementById('imageUploadField').style.display = val === 'Image Hosting' ? 'block' : 'none';
      document.getElementById('redirectField').style.display = val === 'Redirect' ? 'block' : 'none';
    });

    // Upload images to Imgur
    async function uploadImagesToImgur(files) {
      const imageUrls = [];
      const IMGUR_CLIENT_ID = '919e66780dffebb';

      for (const file of files) {
        const formData = new FormData();
        formData.append('image', file);

        try {
          const response = await fetch('https://api.imgur.com/3/image', {
            method: 'POST',
            headers: { Authorization: `Client-ID ${IMGUR_CLIENT_ID}` },
            body: formData
          });
          const data = await response.json();
          imageUrls.push(data.data.link);
        } catch (error) {
          console.error('Error uploading image:', error);
          return null;
        }
      }

      return imageUrls;
    }

    // Handle form submission
    document.getElementById('transferForm').addEventListener('submit', async (event) => {
      event.preventDefault();

      const domainName = document.getElementById('domainName').value.trim();
      const authCode = document.getElementById('authCode').value.trim();
      const reasonSelect = document.getElementById('reasonSelect').value.trim();
      const redirectDomain = document.getElementById('redirectDomain')?.value.trim() || '';
      const customReason = document.getElementById('customReason')?.value.trim() || '';
      const formMessage = document.getElementById('formMessage');

      let reason = '';

      // Validate inputs
      if (!domainName || !authCode || !reasonSelect) {
        formMessage.textContent = 'Please fill out all required fields.';
        formMessage.style.color = '#ff1a1a';
        return;
      }

      if (reasonSelect === 'Redirect') {
        if (!redirectDomain) {
          formMessage.textContent = 'You must specify a redirect domain if "Redirect" is selected.';
          formMessage.style.color = '#ff1a1a';
          return;
        }
        reason = `Redirect to ${redirectDomain}`;
      } else if (reasonSelect === 'Other') {
        if (!customReason) {
          formMessage.textContent = 'You must specify a custom reason if "Other" is selected.';
          formMessage.style.color = '#ff1a1a';
          return;
        }
        reason = customReason;
      } else {
        reason = reasonSelect;
      }

      // Enforce reCAPTCHA
      const recaptchaResponse = document.querySelector('.g-recaptcha-response');
      if (!recaptchaResponse || !recaptchaResponse.value) {
        formMessage.textContent = 'Please complete the reCAPTCHA verification.';
        formMessage.style.color = '#ff1a1a';
        return;
      }

      // Prepare embed
      const embed = {
        title: 'üåê New Hosting Request',
        color: 0xff4d4d,
        fields: [
          { name: 'Domain Name', value: domainName, inline: true },
          { name: 'Authorization Code', value: authCode, inline: true },
          { name: 'Reason for Hosting', value: reason, inline: false }
        ],
        footer: { text: 'HostNet.Wiki Hosting Requests' },
        timestamp: new Date().toISOString()
      };

      // Handle image uploads if applicable
      const files = document.getElementById('images')?.files;
      if (files && files.length > 0) {
        const imageUrls = await uploadImagesToImgur(files);
        if (imageUrls && imageUrls.length > 0) {
          embed.image = { url: imageUrls[0] };
          embed.fields.push({ name: 'Uploaded Images', value: imageUrls.join('\n'), inline: false });
        } else {
          formMessage.textContent = 'Failed to upload images. Please try again later.';
          formMessage.style.color = '#ff1a1a';
          return;
        }
      }

      // Final payload
      const payload = {
        username: 'HostNet.Wiki Bot',
        embeds: [embed]
      };

      // Send to Discord
      try {
        const response = await fetch(DISCORD_WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        if (response.ok) {
          formMessage.textContent = '‚úÖ Request submitted successfully!';
          formMessage.style.color = '#6bff6b';
          document.getElementById('transferForm').reset();
          grecaptcha.reset(); // Reset reCAPTCHA
          setTimeout(() => window.location.href = '/', 2000);
        } else {
          formMessage.textContent = '‚ùå Failed to submit request.';
          formMessage.style.color = '#ff1a1a';
        }
      } catch (error) {
        console.error('Error submitting form:', error);
        formMessage.textContent = '‚ö†Ô∏è An error occurred while sending the request.';
        formMessage.style.color = '#ff1a1a';
      }
    });

    // Initialize on load
    window.addEventListener("load", checkBackendStatus);
  </script>
</body>
</html>
